[
    {
        "title": "Customer Order Frequency",
        "question_content": null,
        "solutions": [],
        "discussions": [
            {
                "id": 1567098,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1568390,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1576274,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1576261,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1575817,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1574468,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1574048,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1570736,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1575178,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1575028,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1567098,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1568390,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1576274,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1576261,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1575817,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1574468,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1574048,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1570736,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1575178,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            },
            {
                "id": 1575028,
                "content": [
                    {
                        "username": "Vaishnav-Dahake",
                        "content": "\\tselect c.customer_id , c.name\\n\\tfrom Customers c\\n\\tinner join Orders o ON c.customer_id = o.customer_id\\n\\tinner join Product p ON o.product_id = p.product_id  \\n\\tGROUP BY c.customer_id , c.name\\n\\thaving sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'6\\' THEN quantity  * price END) >= 100 \\n\\tand\\t   sum( CASE WHEN  YEAR(o.order_date) = \\'2020\\' and month(o.order_date) =\\'7\\'\\tTHEN quantity  * price END) >= 100"
                    },
                    {
                        "username": "AnuragDhar",
                        "content": "with cte as\\n(\\nSelect o.Customer_id, year(o.order_date) as yr, month(o.order_date)as mon,sum(o.quantity*p.price) as quantity from Customers c\\n    right join orders o on c.customer_id=o.order_id\\n    left join product p on o.product_id=p.product_id\\n\\tgroup by o.customer_id,year(o.order_date) ,month(o.order_date)\\n\\t\\n)\\nSelect c1.customer_id,c.name from cte c1 left join customers c\\non c1.customer_id=c.customer_id\\nwhere mon in (6,7) and yr=\\'2020\\' and quantity >=100\\ngroup by c1.customer_id,c.name\\nhaving count(c1.customer_id)=2"
                    },
                    {
                        "username": "maboeths666",
                        "content": "WITH cte1 as (\\nSELECT customer_id, month(order_date) as month, sum(quantity*price) as spending\\nFROM Orders INNER JOIN Product USING(product_id)\\ngroup by month, customer_id\\nhaving spending >= 100)\\n\\n\\nSELECT customer_id, name\\nFROM cte1 INNER JOIN Customers c USING(customer_id)\\nWHERE month = 6 or month = 7 \\ngroup by customer_id\\nHAVING count(month) = 2"
                    },
                    {
                        "username": "rabbit2020",
                        "content": "![image](https://assets.leetcode.com/users/images/c4f40e66-bb07-4fd7-812d-0015349d668d_1642579104.5156043.png)\\n"
                    },
                    {
                        "username": "hsinfangwu",
                        "content": "\\'\\'\\'with cte as(\\nselect c.customer_id,c.name, sum(case when month(order_date)=06 then p.price*o.quantity else 0 end) as t6, \\n sum(case when month(order_date)=07 then p.price*o.quantity else 0 end) as t7\\n \\nfrom Product  p\\njoin Orders o\\non p.product_id = o.product_id\\njoin Customers c\\non c.customer_id=o.customer_id\\ngroup by 1,2\\n  )\\nselect customer_id, name\\nfrom cte\\nwhere t6>=100 and t7>=100\\n\\n\\'\\'\\'"
                    },
                    {
                        "username": "Shri_1992",
                        "content": "\\nselect o.customer_id, c.name from orders o\\ninner join customers c on o.customer_id = c.customer_id\\ninner join product p on o.product_id = p.product_id\\ngroup by  o.customer_id, c.name\\nhaving (sum(case when month(order_date) = \\'6\\' then o.quantity*p.price else 0 end) >=100)  and\\n (sum(case when month(order_date) = \\'7\\' then o.quantity*p.price else 0 end)>=100)\\n\\n\\n"
                    },
                    {
                        "username": "asusundevilmsba2020",
                        "content": "with june as\\n(\\nselect customer_id,\\nsum(price*quantity) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"06\" and year(order_date)= \"2020\"\\n),\\njuly as\\n(select customer_id,order_Date,\\nsum(quantity*price) over (partition by customer_id) as pur\\nfrom\\nOrders O join Product P\\non O.product_id = P.product_id\\nwhere month(order_date)=\"07\" and year(order_date)=\"2020\")\\n\\nselect customer_id,name from Customers\\nwhere customer_id in (select customer_id from june where pur >= 100)\\nand customer_id in (select customer_id from july where pur >= 100)\\n\\n"
                    },
                    {
                        "username": "sophiashao1998",
                        "content": "\\nwith cte as(select C.customer_id, C.name, sum(P.price * O.quantity) as cost, Month(O.order_date) as month from Customers C, Product P, Orders O where C.customer_id = O.customer_id and P.product_id = O.product_id group by C.customer_id, month having cost >= 100)\\nselect customer_id, name from cte where month = 7 or month = 6 group by customer_id having count(customer_id) = 2;"
                    },
                    {
                        "username": "kingtt1011",
                        "content": "with cte as (select *, \\ncase when order_date like \\'2020-06%\\' then quantity  else 0  end as June_qty,\\ncase when order_date like \\'2020-07%\\' then quantity  else 0  end as July_qty from orders)\\n\\nselect c.customer_id,a.name from cte c left join product b on c.product_id=b.product_id left join customers a on c.customer_id=a.customer_id group by c.customer_id having sum(June_qty*price)>=100 and sum(July_qty*price)>=100"
                    },
                    {
                        "username": "haileyqian",
                        "content": "WITH CTE AS(\\nSELECT DISTINCT o.customer_id, name, MONTH(order_date) as month,SUM(price*quantity) OVER(PARTITION BY o.customer_id, MONTH(order_date)) AS spending\\nFROM Orders o\\nLEFT JOIN Customers c\\nON o.customer_id = c.customer_id\\nLEFT JOIN Product p\\nON o.product_id = p.product_id\\nWHERE MONTH(order_date) = 6 OR MONTH(order_date)=7\\n)\\n\\nSELECT customer_id, name\\nFROM(\\nSELECT DISTINCT customer_id,name, COUNT(month) OVER(PARTITION BY customer_id) AS count\\nFROM CTE\\nWHERE spending>=100\\n)T\\nWHERE count =2"
                    }
                ]
            }
        ]
    }
]